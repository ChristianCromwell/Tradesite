"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[59802],{564894:(e,t,n)=>{n.d(t,{hasService:()=>l,registerService:()=>s,service:()=>u,unregisterService:()=>a,waitServiceRegistered:()=>c});var o=n(925049);const i={},r=new Map;function s(e,t){if(l(e))throw new Error("Service already registered");i[e.id]=t;const n=r.get(e.id);void 0!==n&&(r.delete(e.id),n.resolve(t))}function a(e){if(!l(e))throw new Error("Service not found");i[e.id]=void 0}function l(e){return void 0!==i[e.id]}function u(e){const t=i[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function c(e){if(l(e))return Promise.resolve(u(e));let t=r.get(e.id);return void 0===t&&(t=(0,o.createDeferredPromise)(),r.set(e.id,t)),t.promise}},72368:(e,t,n)=>{n.d(t,{canShowNewSymbolSearch:()=>l,getCurrentLocaleInfoCountry:()=>u,isMobile:()=>s,isPlatformMobile:()=>a});var o=n(314802),i=n(931924),r=n(638456);function s(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return r.CheckMobile.any()&&!e}function a(){return!(0,o.isOnMobileAppPage)("any")&&s()}function l(){return!i.enabled("widget")&&!(0,o.isOnMobileAppPage)("any")}function u(){return window.initData?.currentLocaleInfo?.flag.toUpperCase()}},515828:(e,t,n)=>{n.d(t,{MINDS_GROUP_PATH_PATTERN:()=>o,createMindsPath:()=>i});const o="/minds/groups/:symbol/";function i(e,t,n){let i=o.replace(":symbol",encodeURIComponent(e));if(!t)return i;const r=new URLSearchParams;return r.set("mind",t),n&&r.set("editable","true"),i+=`?${r.toString()}`,i}},951713:(e,t,n)=>{n.d(t,{getHideOptions:()=>c,getSavedHideMode:()=>f,toggleHideMode:()=>d});var o=n(650151),i=n(444372),r=n(62802),s=n(699576),a=n(87913),l=n(597101);let u=null;function c(){if(null!==u)return u;const e=(0,s.tradingService)();return u=new Map([["drawings",{label:i.t(null,void 0,n(703217)),dataName:"hide-drawing-tools",tooltip:{active:i.t(null,void 0,n(185891)),inactive:i.t(null,void 0,n(752563))},getBoxedValue:()=>(0,a.hideAllDrawings)(),trackLabel:"hide drawings"}],["indicators",{label:i.t(null,void 0,n(72351)),dataName:"hide-indicators",tooltip:{active:i.t(null,void 0,n(598753)),inactive:i.t(null,void 0,n(178525))},getBoxedValue:()=>(0,a.hideAllIndicators)(),trackLabel:"hide indicators"}],["positions",{label:i.t(null,void 0,n(492226)),dataName:"hide-positions-and-orders",tooltip:{active:i.t(null,void 0,n(420506)),inactive:i.t(null,void 0,n(842164))},getBoxedValue:()=>(0,o.ensureNotNull)(e).showTradedSources,inverted:!0,trackLabel:"hide positions"}],["all",{label:i.t(null,void 0,n(47074)),dataName:"hide-all",tooltip:{active:e?i.t(null,void 0,n(686738)):i.t(null,void 0,n(225881)),inactive:e?i.t(null,void 0,n(418216)):i.t(null,void 0,n(90763))},trackLabel:"hide all"}]]),e||u.delete("positions"),u}function d(e){e?r.setValue("ChartToolsHideMode",e):e=f();const t=h();let n=!t;return"all"===e?(p(((e,t,o)=>{e.setValue(o?!n:n)})),l.hideStateChange.fire({hideMode:e,isActive:n}),n):(p(((o,i,r)=>{if(i===e){const e=t?!r:!o.value();o.setValue(e),n=r?!e:e
}else o.setValue(Boolean(r))})),l.hideStateChange.fire({hideMode:e,isActive:n}),n)}function f(){const e=r.getValue("ChartToolsHideMode","drawings");return c().has(e)?e:"drawings"}function h(){let e=!0;return p(((t,n,o)=>{const i=t.value();e=e&&(o?!i:i)})),e}function p(e){c().forEach(((t,n)=>{const o=t.getBoxedValue?.();o&&e(o,n,t.inverted)}))}},651231:(e,t,n)=>{n.d(t,{getChartWidgetApiTimeConverter:()=>s});var o=n(650151),i=n(482707);const r=n(931924).enabled("end_of_period_timescale_marks");function s(e,t,n){return new l(function(e,t){const n=function(e,t){return e+t.session+t.timezone+(t.corrections||"")+(t.session_holidays||"")}(e,t);let o=a.get(n);void 0===o&&(o=(0,i.createDwmAligner)(e,t),a.set(n,o));return o}(e,t),n)}const a=new Map;class l{constructor(e,t){this._dwmAligner=e,this._chartModel=t}convertPublicTimeToInternalTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToSessionStart(1e3*e)/1e3:e}convertInternalTimeToPublicTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToExchangeTradingDay(1e3*e)/1e3:e}convertTimePointIndexToPublicTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;let n=r?function(e,t){const n=e.indexToUserTime(t);if(null===n)return null;return n.getTime()/1e3}(t,e):this.convertTimePointIndexToInternalTime(e);return null!==n&&(n=this.convertInternalTimeToPublicTime(n)),n}convertTimePointIndexToInternalTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;const n=t.points(),{firstIndex:i,lastIndex:r}=(0,o.ensureNotNull)(n.range().value());let s=null;if(i<=e&&e<=r)s=n.valueAt(e);else if(e>r){const n=this._chartModel.mainSeries().syncModel();if(null!==n){const i=(0,o.ensureNotNull)(t.indexToTimePoint(r));s=n.projectTime(i,e-r)}}return s}}},61e3:(e,t,n)=>{n.r(t),n.d(t,{addSymbolDialogHasOpenedKey:()=>s,showAddSymbolDialog:()=>a});var o=n(541543),i=n(305514),r=n(251954);const s="addSymbolDialogHasOpenedKey";function a(e){(0,o.runOrSigninWithFeature)((()=>{(0,i.showWatchListsDialog)({addSymbols:e,onOpen:l})}),{feature:"watchList",source:"add symbol to watchlist"})}function l(){r.emit(s)}},482707:(e,t,n)=>{n.d(t,{createDwmAligner:()=>u,createTimeToBarTimeAligner:()=>d});var o=n(493239),i=n(931924),r=n(477786),s=n(831116),a=n(807780);const l=new s.SessionInfo("Etc/UTC","0000-0000:1234567");function u(e,t){if(!c()||!r.Interval.isDWM(e))return null;const n=new s.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),i=(0,a.newBarBuilder)(e,n,l);return{timeToSessionStart:e=>i.tradingDayToSessionStart(e),timeToExchangeTradingDay:e=>{const t=(0,o.utc_to_cal)(n.timezone,e),i=n.spec.correctTradingDay(t);return(0,o.set_hms)(i,0,0,0,0,(0,o.get_timezone)("Etc/UTC")),i.getTime()}}}function c(){return!i.enabled("disable_resolution_rebuild")}function d(e,t){if(!c())return e=>e;const n=new s.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),o=(0,a.newBarBuilder)(e,n,n,!1);return e=>o.alignTimeIfPossible(e)}},87913:(e,t,n)=>{n.r(t),n.d(t,{SelectPointMode:()=>o,activePointSelectionMode:()=>Y,alignTo45Degrees:()=>be,
barTimesUnderCursor:()=>X,beenSetLineToolLastPoint:()=>A,cancelLineTool:()=>oe,cancelledLineTool:()=>k,changeLineStyle:()=>he,changeLineTool:()=>ue,changedLineStyle:()=>q,changedLineTool:()=>$,continueLineTool:()=>ne,continuedLineTool:()=>B,copiedLineTool:()=>z,copyLineTool:()=>pe,createLineTool:()=>te,createdLineTool:()=>F,crosshairLock:()=>L,cursorTool:()=>D,drawOnAllCharts:()=>Pe,drawOnAllChartsMode:()=>Re,emojiTool:()=>P,finishChangingLineTool:()=>ce,finishLineTool:()=>fe,finishMovingLineTool:()=>ae,finishedChangingLineTool:()=>j,finishedLineTool:()=>U,finishedMovingLineTool:()=>O,hideAllDrawings:()=>Ie,hideAllIndicators:()=>Me,hideMarksOnBars:()=>_e,iconTool:()=>b,init:()=>ye,isDirectionalMovementActive:()=>C,isStudyEditingNow:()=>Q,isToolCreatingNow:()=>V,isToolEditingNow:()=>N,isToolMovingNow:()=>x,lockDrawings:()=>Le,moveLineTool:()=>se,movedLineTool:()=>K,properties:()=>Se,removeLineTool:()=>de,removedLineTool:()=>H,resetToCursor:()=>v,restoreLineTool:()=>me,restoreLineToolState:()=>ge,restoredLineTool:()=>G,restoredLineToolState:()=>J,runOnDrawingStateReady:()=>we,setLineToolLastPoint:()=>ie,startChangingLineTool:()=>le,startMovingLineTool:()=>re,startedChangingLineTool:()=>W,startedMovingLineTool:()=>E,stickerTool:()=>R,tool:()=>_,toolIsCursor:()=>p,toolIsDemonstration:()=>m,toolIsMeasure:()=>g});var o,i=n(650151),r=n(781567),s=n(890390),a=n(820028),l=n(751094),u=n(547465),c=n(62802),d=n(251954),f=n(345848);!function(e){e[e.None=0]="None",e[e.Replay=1]="Replay",e[e.Study=2]="Study"}(o||(o={}));const h=new Set(["cursor","arrow","dot","performance","demonstration"]);function p(e){return h.has(e)}function m(e){return"demonstration"===e}function g(e){return"measure"===e}function v(e=!1){if(!e&&T){if(T.childs().stayInDrawingMode.value())return}_.setValue(D.value())}let T=null,y=null,w=null,S=null,I=null,M=null;const L=new l.WatchedObject(null),_=new a.WatchedValue,b=new a.WatchedValue,P=new a.WatchedValue,R=new a.WatchedValue,D=new a.WatchedValue,V=new a.WatchedValue(!1),N=new a.WatchedValue(!1),x=new a.WatchedValue(!1),C=new a.WatchedValue(!1),F=new u.Delegate,B=new u.Delegate,k=new u.Delegate,A=new u.Delegate,E=new u.Delegate,K=new u.Delegate,O=new u.Delegate,W=new u.Delegate,$=new u.Delegate,j=new u.Delegate,H=new u.Delegate,U=new u.Delegate,q=new u.Delegate,z=new u.Delegate,G=new u.Delegate,J=new u.Delegate,Y=new a.WatchedValue(o.None),Q=new a.WatchedValue(!1),X=new Map;function Z(e,t){const n=t||{value:!1};return t=>{n.value||(n.value=!0,e.fire(t),n.value=!1)}}const ee={value:!1},te=Z(F,ee),ne=Z(B,ee),oe=Z(k,ee),ie=Z(A,ee),re=Z(E),se=Z(K),ae=Z(O),le=Z(W),ue=Z($),ce=Z(j),de=Z(H),fe=Z(U),he=Z(q,ee),pe=Z(z,ee),me=Z(G),ge=Z(J);let ve=!1,Te=[];function ye(){if(ve)return;const e=c.getValue("chart.cursorPreference","cursor");_.setValue(p(e)?e:"cursor"),_.subscribe((e=>{p(e)?D.setValue(e):"eraser"===e&&(0,f.trackEvent)("Chart cursors",e)}),{callWithLast:!0}),D.subscribe((e=>{(0,f.trackEvent)("Chart cursors",e),e&&"performance"!==e&&!m(e)&&c.setValue("chart.cursorPreference",e)})),T=new s.DefaultProperty({
defaultName:"drawings"}),y=(0,r.createPrimitiveProperty)(!1),w=(0,r.createPrimitiveProperty)(!1),S=(0,r.createPrimitiveProperty)(!1),I=(0,r.createPrimitiveProperty)(!c.getBool("BarsMarksContainer.visibile",!0)),M=(0,r.createPrimitiveProperty)(!1),_.subscribe((e=>{(0,d.emit)("onSelectedLineToolChanged")})),ve=!0,Te.forEach((e=>e())),Te=[]}function we(e){ve?e():Te.push(e)}function Se(){return(0,i.ensureNotNull)(T)}function Ie(){return(0,i.ensureNotNull)(y)}function Me(){return(0,i.ensureNotNull)(w)}function Le(){return(0,i.ensureNotNull)(S)}function _e(){return(0,i.ensureNotNull)(I)}function be(){return(0,i.ensureNotNull)(M)}function Pe(){return Se().childs().drawOnAllCharts}function Re(){return Se().childs().drawOnAllChartsMode}},985841:(e,t,n)=>{n.d(t,{DateFormatter:()=>r});var o=n(191914),i=n(608571);class r{constructor(e="yyyy-MM-dd",t=!1){this._dateFormatFunc=t?(0,i.getDateFormatWithWeekday)(e):i.dateFormatFunctions[e]}format(e){return o.customFormatters&&o.customFormatters.dateFormatter?o.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!1)}formatLocal(e){return o.customFormatters.dateFormatter?o.customFormatters.dateFormatter.formatLocal?o.customFormatters.dateFormatter.formatLocal(e):o.customFormatters.dateFormatter.format(e):this._dateFormatFunc(e,!0)}parse(e){if(""===e)return{res:!1};let t=e;return o.customFormatters&&o.customFormatters.dateFormatter&&!o.customFormatters.dateFormatter.parse&&console.warn("You need to provide a `parse` function as part of `dateFormatter`"),o.customFormatters&&o.customFormatters.dateFormatter&&o.customFormatters.dateFormatter.parse&&(t=String(o.customFormatters.dateFormatter.parse(e))),{res:!0,value:t}}}},303999:(e,t,n)=>{n.d(t,{isTicksEnabled:()=>i});var o=n(638456);n(931924);function i(){return!(0,o.onWidget)()}},702067:(e,t,n)=>{n.d(t,{LineToolCollectedProperty:()=>u,LineToolColorsProperty:()=>d,LineToolWidthsProperty:()=>c,MultipleLineColorsProperty:()=>p,MultipleLineWidthsProperty:()=>h});var o=n(735566),i=n(862150),r=n(421566);const s=(0,o.getLogger)("Chart.LineToolCollectedProperty");class a{applyValue(e,t){e.setValue(t)}}class l extends r.PropertyBase{constructor(e,t){super(),this._properties=e,e.forEach(((e,t)=>e.subscribe(this,((e,n)=>{this._listeners.fire(this,`${t}.${n}`)})))),this._showIfProperty=t}visible(){return!this._showIfProperty||this._showIfProperty?.value()}value(){if(0===this._properties.length)return s.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every((t=>t.value()===e))?e:"mixed"}setValueSilently(e){"mixed"!==e&&this._properties.forEach((t=>t.setValueSilently(e)))}hasChild(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length}childCount(){return this._properties.length}childNames(){return this._properties.map(((e,t)=>t.toString()))}child(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length?this._properties[t]:void 0}destroy(){
this._properties.forEach((e=>e.unsubscribeAll(this))),this._listeners.destroy()}storeStateIfUndefined(){return!0}weakReference(){return(0,i.weakReference)(this)}ownership(){return(0,i.ownership)(this)}}class u extends l{setValue(e,t,n){if("mixed"===e)return;const o=n??new a;this._properties.forEach((t=>o.applyValue(t,e)))}}class c extends u{}class d extends u{firstColor(){return this._properties[0].value()}}class f extends(25242==n.j?l:null){setValue(e,t,n){if("mixed"===e)return;const o=n??new a;this._properties.forEach((t=>t.setValue(e,void 0,o)))}}class h extends(25242==n.j?f:null){}class p extends(25242==n.j?f:null){}},545372:(e,t,n)=>{n.d(t,{cloneLineTool:()=>F,createLineTool:()=>L,createLineToolProperties:()=>b,createStudyLineToolProperties:()=>P,ensureAllLineToolsLoadedForLayout:()=>I,initAllLineToolsFromContent:()=>M,initLineTool:()=>T,isBrushBasedLineTool:()=>D,isEditableTextLineTool:()=>x,isLineTool:()=>p.isLineTool,isTrading:()=>V,prepareLineToolPropertiesByOwnerSource:()=>_,setNewToolProperties:()=>g,supportsPhantomMode:()=>R,tryFindStudyLineToolNameByStudyId:()=>C,unsetNewToolProperties:()=>v});var o=n(182433),i=n(650151),r=n(86441),s=n(816541),a=n(700931),l=n(388741),u=n(529751),c=n(397007),d=n(349811),f=n(181227),h=n(735566),p=n(63358);let m=null;function g(e,t,n){return null!==m&&m.tool===e&&m.toolData===t||(v(!0),m={properties:b(n.backgroundTheme().spawnOwnership(),e,!n.readOnly()),tool:e,toolData:t}),m.properties}function v(e){e&&m?.properties.destroy(),m=null}async function T(e){await(0,f.loadMetaInfoForLinetoolIfRequired)(e);const t=(0,f.asLineToolName)(e);(0,f.isLineToolLoaded)(t)||(0,u.isLineToolName)(t)&&await(0,f.loadLineTool)(t)}function y(e,t){const n="charts"in e?e.charts:[e];for(const e of n){for(const n of e.panes)for(const e of n.sources)t(e.type);e.lineToolsGroups?.groups.forEach((e=>{e.tools.forEach((e=>t(e)))}))}}class w extends Error{constructor(e,t){super(`Failed to load line tool: ${e}`),this.name="LineToolLoadError",this.toolName=e,this.originalError=t}}const S=(0,h.getLogger)("LineToolsSynchronizer");async function I(e){const t=new Set,n=e=>{(0,f.isAsyncGenericLineToolName)(e)&&t.add(e)};for(const t of e)y(t,n);const o=[...t],i=(await Promise.allSettled(o.map((e=>(0,f.ensureLineToolLoaded)(e).catch((t=>{throw new w(e,t)})))))).filter((e=>"rejected"===e.status));i.length>0&&i.forEach((e=>{const t=e.reason;S.logError(`Failed to load line tool: ${t.toolName}`)}))}async function M(e){if(!e)return;const t=new Set;y(e,(e=>{(0,u.isLineToolName)(e)&&t.add(e)})),await Promise.all(Array.from(t).map((e=>T(e))))}function L(e,t,n,o,r,s){(0,i.assert)((0,u.isLineToolName)(e),"Unknown line tool: "+e);const a=(0,f.asLineToolName)(e);let l;if((0,i.assert)((0,f.isLineToolLoaded)(a),`Line tool ${a} is not loaded`),r||n||null===m||m.tool!==e||(n=m.properties,v(!1)),(0,f.isAsyncStudyLineToolName)(a)){l=new((0,f.getLoadedLineTool)(a))(t,n,(0,i.ensureDefined)(o),r,s)}else{l=new((0,f.getLoadedLineTool)(a))(t,n,r,s)}return l.toolname=e,v(!0),l}function _(e,t){const n=(0,
i.ensureNotNull)(t.symbolSource()),o=n.symbolInfo(),r=o?(0,l.extractLineToolSymbolFromSymbolInfo)(o,n.symbol()):n.symbol();e.childs().symbol.setValue(r),n.model().currencyConversionEnabled()&&n.isConvertedToOtherCurrency()&&e.childs().currencyId.setValue(n.currency()),n.model().unitConversionEnabled()&&n.isConvertedToOtherUnit()&&e.childs().unitId.setValue(n.unit()),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function b(e,t,n,o){(0,i.assert)((0,u.isLineToolName)(t),`${t} should be name of the line tool`);const r=(0,f.asLineToolName)(t);if((0,i.assert)((0,f.isLineToolLoaded)(r),`Line tool ${r} is not loaded`),(0,f.isAsyncStudyLineToolName)(r)){return(0,f.getLoadedLineTool)(r).createProperties(e,o)}return(0,f.getLoadedLineTool)(r).createProperties(e,o,n)}function P(e,t,n,o,r,s){(0,i.assert)((0,u.isStudyLineToolName)(t),`${t} should be name of the study line tool`);const a=(0,f.asLineToolName)(t);if((0,f.isAsyncStudyLineToolName)(a)){return(0,f.getLoadedLineTool)(a).createPropertiesFromStudyMetaInfoAndState(n,o,r,s,e)}throw new Error(`Property creation is not implemented for study line tool ${t}`)}function R(e){(0,i.assert)((0,u.isLineToolName)(e),`${e} should be name of the line tool`);const t=(0,f.asLineToolName)(e);(0,i.assert)((0,f.isLineToolLoaded)(t),`Line tool ${t} is not loaded`);const n=(0,f.getLoadedLineTool)(t);return void 0!==n&&Boolean(n.supportPhantomMode)}function D(e){return e instanceof d.LineToolBrushBase}function V(e){return e instanceof a.LineToolTrading}const N=["editableTextStyle","editableText","editableTextProperties"];function x(e){return(0,o.default)(e)&&N.every((t=>t in e))}function C(e){let t=null;return e===c.lineToolsStudyIds.LineToolRegressionTrend?t="LineToolRegressionTrend":e===c.lineToolsStudyIds.LineToolVbPFixed?t="LineToolVbPFixed":e===c.lineToolsStudyIds.LineToolFixedRangeVolumeProfile&&(t="LineToolFixedRangeVolumeProfile"),t}function F(e,t,n,o){const a=t.toolname,l=t.properties().state();l.intervalsVisibilities=(0,s.mergeIntervalVisibilitiesDefaults)(l?.intervalsVisibilities);const u=b(e.backgroundTheme().spawnOwnership(),t.toolname,!e.readOnly(),l);u.childs().visible.setValue(!0);const c=(0,i.ensureNotNull)(t.ownerSource()),d=L(a,e,u);void 0!==o&&d.setId(o),d.setOwnerSource(c),d.toolname=a;const f=d.clonePositionOffset();if(t.isFixed()){const e=(0,i.ensureDefined)(t.fixedPoint()),o=n?e.add(new r.Point(f.xCoordOffset,f.yCoordOffset)):e;d.addFixedPoint(o)}const h=t.normalizedPoints(),p=n?function(e,t,n){const o=(0,i.ensureNotNull)(t.priceScale()),r=(0,i.ensureNotNull)(t.firstValue());return e.map((e=>{const t=e.price,i=o.priceToCoordinate(t,r)+n.yCoordOffset,s=o.coordinateToPrice(i,r),a=e.interval;return{time_t:e.time_t,price:s,offset:e.offset+n.barOffset,interval:a}}))}(h,c,f):h,m=t.points();return d.restorePoints(p,m),d.cloneData&&d.cloneData(t),d.recalculateStateByData&&d.recalculateStateByData(),d}},515072:(e,t,n)=>{n.d(t,{magnetEnabled:()=>g,magnetMode:()=>v,magnetSnapsToIndicators:()=>T,setIsMagnetEnabled:()=>y,setMagnetMode:()=>w,
setMagnetSnapsToIndicators:()=>S});var o=n(890390),i=n(820028),r=n(590729),s=n(87913),a=n(529751),l=n(728136);const u=new i.WatchedValue(!1),c=new i.WatchedValue(r.MagnetMode.WeakMagnet),d=new i.WatchedValue(!1),f=(0,l.modifierPressed)(),h=(0,l.shiftPressed)();function p(){const e=f.value();if(h.value()&&(s.isToolEditingNow.value()||s.isToolCreatingNow.value()))return void u.setValue(!1);let t,n;if(s.activePointSelectionMode.value()===s.SelectPointMode.Replay)t=n=!1;else{const o=s.tool.value(),i=s.isStudyEditingNow.value()||s.activePointSelectionMode.value()===s.SelectPointMode.Study;t=e&&((0,a.isLineToolName)(o)||s.isToolEditingNow.value()||(0,s.toolIsMeasure)(o)||i),n=(0,s.properties)().childs().magnet.value()}c.setValue(!n&&t?r.MagnetMode.StrongMagnet:(0,s.properties)().childs().magnetMode.value()),u.setValue(t?!n:n)}function m(){d.setValue((0,s.properties)().childs().magnetSnapsToIndicators.value())}function g(){return u}function v(){return c}function T(){return d}function y(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnet.setValue(e),(0,o.allowSavingDefaults)(!1)}function w(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnetMode.setValue(e),(0,s.properties)().childs().magnet.setValue(!0),(0,o.allowSavingDefaults)(!1)}function S(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnetSnapsToIndicators.setValue(e),(0,o.allowSavingDefaults)(!1)}(0,s.runOnDrawingStateReady)((()=>{(0,s.properties)().childs().magnet.subscribe(null,p),(0,s.properties)().childs().magnetMode.subscribe(null,p),(0,s.properties)().childs().magnetSnapsToIndicators.subscribe(null,m),f.subscribe(p),h.subscribe(p),s.tool.subscribe(p),s.isToolEditingNow.subscribe(p),p(),m()}))},596443:(e,t,n)=>{n.d(t,{compareResolutions:()=>m,convertResolutionsFromSettings:()=>P,getApplicableIntervalForFrequency:()=>g,getDefaultResolution:()=>I,getMaxResolutionValue:()=>b,getResolutionByChartStyle:()=>M,getTranslatedResolution:()=>V,getTranslatedResolutionModel:()=>N,intervalIsSupported:()=>k,isAvailable:()=>w,isIntervalEnabled:()=>B,isResolutionMultiplierValid:()=>L,isSecondsEnabled:()=>C,mergeResolutions:()=>R,normalizeIntervalString:()=>y,setLastUsedResolution:()=>S,sortResolutions:()=>D});var o=n(444372),i=n(477786),r=n(388741),s=n(62802),a=n(583912),l=n(999102),u=n(536794),c=n(931924),d=n(303999);const f={[i.ResolutionKind.Ticks]:1,[i.ResolutionKind.Seconds]:60,[i.ResolutionKind.Minutes]:1440,[i.SpecialResolutionKind.Hours]:24,[i.ResolutionKind.Days]:365,[i.ResolutionKind.Weeks]:52,[i.ResolutionKind.Months]:12,[i.ResolutionKind.Range]:1e6,[i.ResolutionKind.Invalid]:NaN},h={[i.ResolutionKind.Ticks]:0,[i.ResolutionKind.Seconds]:1,[i.ResolutionKind.Minutes]:2,[i.SpecialResolutionKind.Hours]:3,[i.ResolutionKind.Days]:4,[i.ResolutionKind.Weeks]:5,[i.ResolutionKind.Months]:6,[i.ResolutionKind.Range]:7,[i.ResolutionKind.Invalid]:8};function p(e){const t=i.Interval.parse(e),n=t.multiplier()||1;return t.isMinuteHours()?[i.SpecialResolutionKind.Hours,n/60]:[t.kind(),n]}function m(e,t){if(e===t)return 0
;const[n,o]=p(e),[i,r]=p(t);return n!==i?h[n]-h[i]:o-r}function g(e,t){return m(t,e)>=0?t:e}const v=[1,5,10,15,30,45],T=[1,10,100,1e3];function y(e){return i.Interval.parse(e).value()}function w(e){const t=i.Interval.parse(e);if(t.isRange())return a.linking.range.value();if(!(0,d.isTicksEnabled)()&&t.isTicks())return!1;const n=t.value(),o=a.linking.dataFrequencyResolution.value();if(void 0!==o&&m(n,o)<0)return!1;const r=a.linking.supportedResolutions.value();return void 0!==r?void 0!==r.find((e=>y(e)===n)):t.isTicks()?Boolean(a.linking.ticks.value()):t.isIntraday()?Boolean(a.linking.intraday.value()):t.isDWM()}function S(e){i.Interval.isValid(e)&&(i.Interval.isRange(e)?s.setValue("chart.lastUsedRangeResolution",e):s.setValue("chart.lastUsedTimeBasedResolution",e))}function I(e){return e?"100R":"1D"}function M(e,t,n){const o=r.isRangeStyle(e),a=i.Interval.isRange(t);return!o&&a?function(e){const t=s.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==t&&i.Interval.isTimeBased(t))return t;let n="1D";for(const t of e){const e=i.Interval.parse(t);if(e.isTimeBased()){const t=e.value();if("1D"===t)return t;n=t}}return n}(n):o&&!a?function(e){const t=s.getValue("chart.lastUsedRangeResolution");if(void 0!==t&&i.Interval.isRange(t))return t;let n="100R";for(const t of e){const e=i.Interval.parse(t);if(e.isRange()){const t=e.value();if("100R"===t)return t;n=t}}return n}(n):t}function L(e){const{interval:t,guiResolutionKind:n}=i.Interval.parseExt(e);if(!t.isValid())return!1;const o=t.multiplier();if(n===i.ResolutionKind.Seconds)return v.includes(o);if((0,d.isTicksEnabled)()&&n===i.ResolutionKind.Ticks)return T.includes(o);return(n===i.SpecialResolutionKind.Hours?o/60:o)<=_(n)}function _(e){const t=f[e];return Number.isNaN(t)?1:t}function b(e){return _(i.Interval.parseExt(e).guiResolutionKind)}function P(e){return Array.isArray(e)?e:Object.keys(e).map(i.Interval.normalize).filter(u.notNull)}function R(...e){let t=[].concat(...e);return t=(0,l.uniq)(t.filter(L).map(y)),D(t)}function D(e){return e.sort(m)}function V(e){const{multiplier:t,shortKind:n}=N(e);return`${t}${n}`}function N(e,t){const n=i.Interval.parse(e);let o=n.multiplier(),r=n.kind();if(!n.isValid()){if(t)return null;throw new TypeError(`Can't translate invalid interval: ${e}`)}return n.isMinuteHours()&&(o=Math.floor(o/60),r=i.SpecialResolutionKind.Hours),{multiplier:o.toString(),shortKind:x(r),hint:`${o} ${x(r,o)}`,mayOmitMultiplier:n.isDWM()&&1===o,mayOmitShortKind:n.isMinutes()&&!n.isMinuteHours()}}function x(e,t){if(!t)return{[i.ResolutionKind.Invalid]:"",[i.ResolutionKind.Ticks]:o.t(null,{context:"interval_short"},n(882901)),[i.ResolutionKind.Seconds]:o.t(null,{context:"interval_short"},n(968823)),[i.ResolutionKind.Minutes]:o.t(null,{context:"interval_short"},n(768430)),[i.SpecialResolutionKind.Hours]:o.t(null,{context:"interval_short"},n(438048)),[i.ResolutionKind.Days]:o.t(null,{context:"interval_short"},n(38691)),[i.ResolutionKind.Weeks]:o.t(null,{context:"interval_short"},n(307408)),[i.ResolutionKind.Months]:o.t(null,{context:"interval_short"
},n(977995)),[i.ResolutionKind.Range]:o.t(null,{context:"interval_short"},n(993934))}[e];switch(e){case i.ResolutionKind.Ticks:return o.t(null,{plural:"ticks",count:t},n(111913));case i.ResolutionKind.Days:return o.t(null,{plural:"days",count:t},n(641807));case i.ResolutionKind.Weeks:return o.t(null,{plural:"weeks",count:t},n(448898));case i.ResolutionKind.Months:return o.t(null,{plural:"months",count:t},n(898393));case i.ResolutionKind.Seconds:return o.t(null,{plural:"seconds",count:t},n(33232));case i.ResolutionKind.Minutes:return o.t(null,{plural:"minutes",count:t},n(378318));case i.SpecialResolutionKind.Hours:return o.t(null,{plural:"hours",count:t},n(942328));case i.ResolutionKind.Range:return o.t(null,{plural:"ranges",count:t},n(189937));default:return e}}function C(){return!0}function F(e){return!(!(0,d.isTicksEnabled)()&&e.isTicks())}function B(e){return F(i.Interval.parse(e))}function k(e){if(c.enabled("allow_supported_resolutions_set_only")){const t=i.Interval.normalize(e);return null!==t&&w(t)}{const t=i.Interval.parse(e);if(!t.isValid()||!F(t))return!1;if(!c.enabled("custom_resolutions")){const t=i.Interval.normalize(e),n=window.ChartApiInstance.defaultResolutions().filter(B);if(!t||-1===n.indexOf(t))return!1}const n=a.linking.dataFrequencyResolution.value();if(void 0!==n&&g(n,t.value())!==t.value())return!1;if(t.isRange())return a.linking.range.value();if(t.isTicks())return a.linking.ticks.value();if(t.isIntraday())return a.linking.intraday.value();{const e=a.linking.supportedResolutions.value();return!e||e.includes(t.value())}}}},87347:(e,t,n)=>{n.d(t,{emptyPineId:()=>m,isStudyDescriptor:()=>g,studyMetaInfoRepository:()=>w});var o=n(481251),i=n(444372),r=n(650151),s=n(77295),a=n(301320),l=n(886338),u=n(192809),c=n(870408),d=n(401843),f=n(735566),h=n(925049);const p=(0,f.getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"}),m="";function g(e){return"object"==typeof e&&null!==e&&"type"in e&&("java"===e.type&&"studyId"in e||"pine"===e.type&&"pineId"in e)}class v{constructor(e){this._isReady=!1,this._studyVersioning=null,this._rawStudiesMetaInfo=[],this._rawStudiesMetaInfoDeferredPromise=null,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._compileErrors=new WeakMap,this._studiesMigrations=[],this._chartApi=e}async requestMetaInfo(){if(null===this._rawStudiesMetaInfoDeferredPromise){this._rawStudiesMetaInfoDeferredPromise=(0,h.createDeferredPromise)();const e=await this._chartApi.requestMetadata(),t=e.params[1].metainfo.slice();{const n=e.params[1].migrations.slice();this._processSiteMetaInfo(t,n)}this._studyVersioning=new u.StudyVersioning(this._javaStudiesMetaInfo,this._studiesMigrations),this._requestFinished(),this._rawStudiesMetaInfoDeferredPromise.resolve(this._rawStudiesMetaInfo)}return this._rawStudiesMetaInfoDeferredPromise.promise}async findById(e){this._isReady||await this.requestMetaInfo();const t=this._findStudyMetaInfo(e);if(null!==t){const e=this._compileErrors.get(t);return e?Promise.reject(e):Promise.resolve(t)}
return"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}async findAllJavaStudies(){return this._isReady||await this.requestMetaInfo(),this._javaStudiesMetaInfo}studyVersioning(){return(0,r.ensureNotNull)(this._studyVersioning)}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}addPineMetaInfo(e,t){const n=y(this._pineMetaInfoCache,e);return t&&(!Array.isArray(t)||t.length>0)&&(t=Array.isArray(t)?new d.PineCompileFailErrorImpl({warnings:[],errors:t},e):t,this._compileErrors.set(n,t)),n}async getLatestMetaInfoForPineStudy(e,t){const n=await(0,c.requestUserScripts)();let o;if(n){const i=n.find((t=>t.scriptIdPart===e));if(i){const e=l.Version.parse(t),n=l.Version.parse(i.version);e.isLess(n)&&(o=i.version)}}if(void 0!==o){const t={type:"pine",pineId:e,pineVersion:o};return this.findById(t)}return null}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)u.StudyVersioning.verifyInputsMaxValue(t),T(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)y(this._javaStudiesMetaInfo,e);s.StudyMetaInfo.overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestFinished(){this._isReady=!0}_findStudyMetaInfo(e){return"java"===e.type?((0,r.assert)(0!==this._javaStudiesMetaInfo.length,"Java studies metainfo should be define here"),this._javaStudiesMetaInfo.find((t=>t.id===e.studyId))||null):this._pineMetaInfoCache.find((t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,r.ensureDefined)(t.pine).version===e.pineVersion)))||null}_compilePine(e){p.logNormal(`Compiling ${e.pineId} script`);const t=(0,c.translateScriptAsync2)(e.pineId,e.pineVersion||"last").then((({metaInfo:t,compileErrors:n})=>(p.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,r.ensureDefined)(t),n.errors))));return t.catch((t=>{t instanceof d.PineCompileFailErrorImpl&&this.addPineMetaInfo(t.metaInfo,t),p.logNormal(`Compiling ${e.pineId} is failed`)})),t}}function T(e){e.description_localized=i.t(e.description,{context:"study"},n(783477))}function y(e,t){const n=new s.StudyMetaInfo(t).state();(0,a.migrateMetaInfoAndPropState)(n);const o=new s.StudyMetaInfo(n);let i=!0;const r=e.findIndex((e=>e.id===o.id));if(-1===r)e.push(o);else{const t=e[r],n=void 0!==t.pine?l.Version.parse(t.pine.version):null,s=void 0!==o.pine?l.Version.parse(o.pine.version):null;null===s||null===n||s.isGreaterOrEqual(n)?(t.removeDefaults(),e[r]=o):i=!1}return i&&o.createDefaults(),o}const w=(0,o.default)((()=>new v(window.ChartApiInstance)))},960433:(e,t,n)=>{n.d(t,{TextWidthCache:()=>r,getMinTextMetrics:()=>i});var o=n(850117);function i(e){return{width:e.width,actualBoundingBoxAscent:e.actualBoundingBoxAscent,actualBoundingBoxDescent:e.actualBoundingBoxDescent,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}
class r{constructor(e=150){this._fontStyle="",this._cache=new o.CircularCacheBuffer(e,1.5)}reset(){this._cache.clear()}measureText(e,t){return this.getMetrics(e,t).width}yMidCorrection(e,t){const n=this.getMetrics(e,t);return void 0!==n.actualBoundingBoxAscent&&void 0!==n.actualBoundingBoxDescent?(n.actualBoundingBoxAscent-n.actualBoundingBoxDescent)/2:0}getMetrics(e,t){e.font!==this._fontStyle&&(this.reset(),this._fontStyle=e.font);const n=this._cache.get(t);if(void 0!==n)return n;const o=e.textBaseline;e.textBaseline="middle";const r=i(e.measureText(t));return e.textBaseline=o,0===r.width&&t.length||this._cache.set(t,r),r}}},374122:(e,t,n)=>{n.d(t,{setSupportPortalProblemsHost:()=>i,supportPortalProblemsHost:()=>o});let o="";function i(e){o=e}},541543:(e,t,n)=>{n.d(t,{runOrSigninWithFeature:()=>s});var o=n(120296),i=n(362313),r=n(314802);const s=(e,t)=>{{if((0,r.isOnMobileAppPage)("any"))return void window.runOrSignIn(e,t);const n=[];if(t.paidAccountCheck&&n.push((()=>(0,o.paidAccountCheck)({successButtonText:t.paidAccountSuccessButtonText}))),window.is_authenticated)n.reduce(((e,t)=>e.then(t)),Promise.resolve()).then(e).catch((()=>{}));else{const n={source:t.source,sourceMeta:t.sourceMeta,feature:t.feature,mode:t.mode,startTrial:t.startTrial};(0,i.createRunOrSigniWithFeatureDialog)({signInSuccess:e,options:n})}}};window.TradingView.runOrSigninWithFeature=s},904207:(e,t,n)=>{n.d(t,{getTranslatedSymbolDescription:()=>r});var o=n(444372);function i(e){const t=`#${e}-symbol-description`,i=o.t(t,void 0,n(956316));return i===t?null:i}function r(e){if(void 0!==e.pro_name){const t=i(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=i(e.short_name);if(null!==t)return t}}return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language||"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}}}]);